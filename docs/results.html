<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Evolution of Glacier Fed Water Resource - 3&nbsp; Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./d3graph.html" rel="next">
<link href="./data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Evolution of Glacier Fed Water Resource</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/juliemeunier/Glacier-and-fresh-water-ressources" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d3graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#global-assessment-of-lake-types" id="toc-global-assessment-of-lake-types" class="nav-link active" data-scroll-target="#global-assessment-of-lake-types"><span class="header-section-number">3.1</span> Global assessment of lake types</a></li>
  <li><a href="#evolution-of-glacier-fed-lakes-in-the-us" id="toc-evolution-of-glacier-fed-lakes-in-the-us" class="nav-link" data-scroll-target="#evolution-of-glacier-fed-lakes-in-the-us"><span class="header-section-number">3.2</span> Evolution of glacier-fed lakes in the US</a>
  <ul class="collapse">
  <li><a href="#glacier-fed-lakes-from-the-rocky-mountains" id="toc-glacier-fed-lakes-from-the-rocky-mountains" class="nav-link" data-scroll-target="#glacier-fed-lakes-from-the-rocky-mountains"><span class="header-section-number">3.2.1</span> Glacier-fed lakes from the Rocky Mountains</a></li>
  <li><a href="#control-lakes-not-glacier-fed" id="toc-control-lakes-not-glacier-fed" class="nav-link" data-scroll-target="#control-lakes-not-glacier-fed"><span class="header-section-number">3.2.2</span> Control lakes, not glacier-fed</a></li>
  </ul></li>
  <li><a href="#the-impact-of-temperature-precipitation-and-snowfall-on-the-surface-variations-of-lakes-in-the-boulder-area-co" id="toc-the-impact-of-temperature-precipitation-and-snowfall-on-the-surface-variations-of-lakes-in-the-boulder-area-co" class="nav-link" data-scroll-target="#the-impact-of-temperature-precipitation-and-snowfall-on-the-surface-variations-of-lakes-in-the-boulder-area-co"><span class="header-section-number">3.3</span> The impact of temperature, precipitation and snowfall on the surface variations of lakes in the Boulder area, CO</a>
  <ul class="collapse">
  <li><a href="#impact-of-temperature-on-surface-variations" id="toc-impact-of-temperature-on-surface-variations" class="nav-link" data-scroll-target="#impact-of-temperature-on-surface-variations"><span class="header-section-number">3.3.1</span> Impact of temperature on surface variations</a></li>
  <li><a href="#impact-of-snowfalls-and-precipitation-on-surface-variations" id="toc-impact-of-snowfalls-and-precipitation-on-surface-variations" class="nav-link" data-scroll-target="#impact-of-snowfalls-and-precipitation-on-surface-variations"><span class="header-section-number">3.3.2</span> Impact of snowfalls and precipitation on surface variations</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/juliemeunier/Glacier-and-fresh-water-ressources/edit/main/results.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/juliemeunier/Glacier-and-fresh-water-ressources/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="global-assessment-of-lake-types" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="global-assessment-of-lake-types"><span class="header-section-number">3.1</span> Global assessment of lake types</h2>
<p>The first step of our study is to use the GLRSED dataset, which contains the characteristics of a large number of lakes accross the globe. The goal here is to assess the importance of glacier and permafrost in providing freshwater and to identify the area of the globe that rely more heavily no melting ice for freshwater.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>GLRSED <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/GLRSED_GeoPackage_V1.0/GLRSED_GeoPackage_V1.0/GLRSEDV1.gpkg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `glrsed_v1' from data source 
  `C:\Users\meuni\Documents\EDAV\final project\GLRSED_GeoPackage_V1.0\GLRSED_GeoPackage_V1.0\GLRSEDV1.gpkg' 
  using driver `GPKG'
Simple feature collection with 2171501 features and 22 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -180 ymin: -55.86514 xmax: 180 ymax: 83.57595
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of lakes based on glacier and permafrost feeding</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>count_types <span class="ot">&lt;-</span> GLRSED <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Mountain, SWORD, Glacier, Country, Continent, Lake_area)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>count_types<span class="sc">$</span>Permafrost <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(GLRSED<span class="sc">$</span>Permafrost<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>count_types<span class="sc">$</span>Reservoir <span class="ot">&lt;-</span>  <span class="fu">ifelse</span>(GLRSED<span class="sc">$</span>Reservoir<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> GLRSED<span class="sc">$</span>GOODD<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>count_types<span class="sc">$</span>Endorheic <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(GLRSED<span class="sc">$</span>Endorheic<span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>count_types <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(count_types)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>long_types <span class="ot">&lt;-</span> count_types <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">'Mountain'</span>, <span class="st">'SWORD'</span>, <span class="st">'Glacier'</span>, <span class="st">'Permafrost'</span>, <span class="st">'Reservoir'</span>, <span class="st">'Endorheic'</span>), <span class="at">names_to =</span> <span class="st">"LakeType"</span>, <span class="at">values_to =</span> <span class="st">"IsType"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>Total<span class="ot">&lt;-</span> count_types<span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Continent)<span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Count =</span> <span class="fu">n</span>(), <span class="at">TotalArea =</span> <span class="fu">sum</span>(Lake_area), <span class="at">.by =</span> <span class="fu">c</span>(Country))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>summary_by_country <span class="ot">&lt;-</span> long_types<span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">SumLake =</span> <span class="fu">n</span>(), <span class="at">SumArea =</span> <span class="fu">sum</span>(Lake_area), <span class="at">.by =</span> <span class="fu">c</span>(Continent, Country, LakeType, IsType))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>summary_by_country <span class="ot">&lt;-</span> <span class="fu">merge</span>(summary_by_country, Total, <span class="at">by.x =</span> <span class="st">"Country"</span>, <span class="at">by.y =</span> <span class="st">"Country"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>summary_by_country<span class="sc">$</span>percent_nLake <span class="ot">&lt;-</span> summary_by_country<span class="sc">$</span>SumLake<span class="sc">/</span>summary_by_country<span class="sc">$</span>Count <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>summary_by_country<span class="sc">$</span>percent_area <span class="ot">&lt;-</span> summary_by_country<span class="sc">$</span>SumArea<span class="sc">/</span>summary_by_country<span class="sc">$</span>TotalArea <span class="sc">*</span><span class="dv">100</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>summary_by_country <span class="ot">&lt;-</span> summary_by_country <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(IsType <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting bar charts</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> Total<span class="sc">%&gt;%</span><span class="fu">summarize</span>(<span class="at">count=</span><span class="fu">sum</span>(Count), <span class="at">area=</span><span class="fu">sum</span>(TotalArea))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#number of lakes of each type</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plot_count <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_by_country, <span class="fu">aes</span>(<span class="at">x=</span>LakeType,  <span class="at">y=</span>SumLake)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"cornflowerblue"</span>)<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>total<span class="sc">$</span>count, <span class="at">group=</span><span class="dv">1</span>), <span class="at">linewidth=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Count by Lake Type"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lake Type"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#area of lakes</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plot_area <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_by_country, <span class="fu">aes</span>(<span class="at">x=</span>LakeType,  <span class="at">y=</span>SumArea)) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"cornflowerblue"</span>)<span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>total<span class="sc">$</span>area, <span class="at">group=</span><span class="dv">1</span>), <span class="at">linewidth=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Area by Lake Type"</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lake Type"</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Area"</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot_count, plot_area, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From these first bar charts we can notice a few things:</p>
<ul>
<li>Endorheic - no outflow - lakes are few in number but account for a significant portion of the global lake surface.</li>
<li>There are only a few glacier-fed lakes on the planet and they account for only a tiny portion of the global lake surface.</li>
<li>A tenth of the world’s lakes are in a mountainous region. They account for almost a third of the total surface area. This is consistent with the fact that freshwater generally flows from the peaks to the plains.</li>
<li>Permafrost lakes, on the other hand, are numerous and account for almost a third of the planet’s total lake surface.</li>
<li>The majority of the lakes are natural.Nevertheless, human-built reservoir seems to be large as they account for a sixth of the global lake surface.</li>
<li>SWORD lakes i.e.&nbsp;whether the lake is on a river or not are few in number but account for almost half of global lake surface. It means the lakes that are on rivers are large.</li>
</ul>
<p>The rest of our work focuses on lakes created by melting glaciers and permafrost.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>vcd<span class="sc">::</span><span class="fu">mosaic</span>(Glacier <span class="sc">+</span> Permafrost <span class="sc">~</span> Mountain <span class="sc">+</span> SWORD, count_types, <span class="at">direction =</span> <span class="fu">c</span>(<span class="st">"v"</span>, <span class="st">"v"</span>, <span class="st">"h"</span>, <span class="st">"h"</span>), <span class="at">highlighting_fill=</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">4</span>, <span class="st">"Set3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The majority of permafrost and glacier-fed lakes are not located on rivers. In fact, the lakes created by melting glaciers and permafrost are located upstream near the source.</p>
<p>If glacier-fed lakes are all located in mountainous areas, permafrost lakes can also be on plains at low altitudes. Indeed, permafrost exists both at high latitudes and altitudes, the key point being that a cryosol must be permanently frozen, at least for two years, and therefore impermeable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#area by continents</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_by_country, <span class="fu">aes</span>(<span class="at">x=</span>LakeType,  <span class="at">y=</span>SumArea)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">"cornflowerblue"</span>)<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Continent)<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Area by Lake Types by Continent"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lake Type"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Area"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>North America and Asia are the continents that rely the most on permafrost and glacier water. Both Canada and Russia have a large part of their territory that is frozen all year long since they are located at high latitudes.</p>
<p>Unsurprinsigly, Africa doesn’t have any glacier and permafrost lakes despite the mountainous regions as the climate doesn’t allow for durable ice. The last glaciers of Mount Kilimanjaro will disappear before 2050 due to global warming.</p>
<p>The following graphs are an attempt to create an indicator to to assess the regions’ dependence on water from glaciers and permafrost. It is based on the proportion of freshwater surface area available from glaciers and permafrost. This is only an approximation, however, and some lakes are counted twice in this indicator, as they are derived from both glacier melt and permafrost. Nevertheless, it gives an idea of the impact that the disappearance of these water sources could have in these regions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#indicator for ranking countries depending on how much they rely on glacier or permafrost water</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>countries_indicator <span class="ot">&lt;-</span> summary_by_country<span class="sc">%&gt;%</span><span class="fu">select</span>(Country)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>countries_indicator<span class="sc">$</span>percent_nLake<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(summary_by_country<span class="sc">$</span>LakeType<span class="sc">==</span><span class="st">"Glacier"</span><span class="sc">|</span>summary_by_country<span class="sc">$</span>LakeType<span class="sc">==</span><span class="st">"Permafrost"</span>, summary_by_country<span class="sc">$</span>percent_nLake, <span class="dv">0</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>countries_indicator<span class="sc">$</span>percent_area<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(summary_by_country<span class="sc">$</span>LakeType<span class="sc">==</span><span class="st">"Glacier"</span><span class="sc">|</span>summary_by_country<span class="sc">$</span>LakeType<span class="sc">==</span><span class="st">"Permafrost"</span>, summary_by_country<span class="sc">$</span>percent_area, <span class="dv">0</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>countries_indicator<span class="ot">&lt;-</span> countries_indicator<span class="sc">%&gt;%</span><span class="fu">summarize</span>(<span class="at">Count =</span> <span class="fu">n</span>(),<span class="at">percent_nLake =</span> <span class="fu">sum</span>(percent_nLake), <span class="at">percent_area=</span><span class="fu">sum</span>(percent_area), <span class="at">.by =</span> Country)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(countries_indicator)[<span class="fu">colnames</span>(countries_indicator) <span class="sc">==</span> <span class="st">"Country"</span>] <span class="ot">&lt;-</span> <span class="st">"country"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Télécharger des données géospatiales pour les pays</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>world<span class="sc">$</span>name_sort <span class="ot">&lt;-</span> <span class="fu">toupper</span>(world<span class="sc">$</span>name_long)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fusionner les données géospatiales avec les données d'indicateurs</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>partial_match <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  matching_indices <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, <span class="cf">function</span>(name) <span class="fu">agrep</span>(name, y, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>, <span class="at">value =</span> <span class="cn">TRUE</span>, <span class="at">max.distance =</span> <span class="fl">0.1</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  matching_indices <span class="ot">&lt;-</span> <span class="fu">lapply</span>(matching_indices, <span class="cf">function</span>(matching_index) <span class="fu">ifelse</span>(<span class="fu">length</span>(matching_index) <span class="sc">&gt;</span> <span class="dv">0</span>, matching_index[<span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  matching_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(matching_indices)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  matching_indices[<span class="sc">!</span><span class="fu">is.na</span>(matching_indices)]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform partial matching</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>matching_indices_indic <span class="ot">&lt;-</span> <span class="fu">partial_match</span>(countries_indicator<span class="sc">$</span>country, world<span class="sc">$</span>name_long)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>matching_indices_world <span class="ot">&lt;-</span> <span class="fu">partial_match</span>(world<span class="sc">$</span>name_long, countries_indicator<span class="sc">$</span>country)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge based on matching indices</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>world_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(world, countries_indicator, <span class="at">by.x =</span> <span class="st">"name_sort"</span>, <span class="at">by.y =</span> <span class="st">"country"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>world_data<span class="sc">$</span>percent_area[world_data<span class="sc">$</span>percent_area <span class="sc">&gt;</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer la carte du monde avec ggplot2</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world_data, <span class="fu">aes</span>(<span class="at">fill =</span> percent_area)) <span class="sc">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">na.value =</span> <span class="st">"grey40"</span>, <span class="at">name =</span> <span class="st">"Percentage"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"World Map with percentage of freshwater lakes surface from glacier and permafrost "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The map above shows which countries rely most heavily on glaciers and permafrost to fill their freshwater lakes. High-latitude countries are heavily dependent on water from melting permafrost and appear in the darker shade of red here. Countries with large mountain ranges have glaciers and permafrost at altitude. They depend on these melting glaciers for their freshwater reserves in summer.</p>
<p>The indicator on proportion of area of freshwater lakes from glacier and permafrost enables us to identify the most and least ice dependent countries.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List of Ice dependent countries using percentage of area</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>IceFed <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"SVALBARD AND JAN MAYEN"</span>, <span class="st">"GREENLAND"</span>, <span class="st">"ANDORRA"</span>, <span class="st">"KYRGYZSTAN"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>NoIce <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"SOUTH AFRICA"</span>, <span class="st">"SUDAN"</span>, <span class="st">"ZAMBIA"</span>, <span class="st">"TANZANIA"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>most_ice_summary <span class="ot">&lt;-</span> summary_by_country <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">%in%</span> IceFed)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>least_ice_summary <span class="ot">&lt;-</span> summary_by_country <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Country <span class="sc">%in%</span> NoIce)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>most <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(most_ice_summary, <span class="fu">aes</span>(<span class="at">x=</span>LakeType,  <span class="at">y=</span>percent_area)) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Country)<span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Most ice dependent countries"</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lake Type"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage of area"</span>) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>least <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(least_ice_summary, <span class="fu">aes</span>(<span class="at">x=</span>LakeType,  <span class="at">y=</span>percent_area)) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Country)<span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Least ice dependent countries"</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Lake Type"</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage of area"</span>) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(most, least, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Comparing the different percentage of areas for ice dependent countries enables us to separate them into two categories which have already been briefly mentioned:</p>
<ol type="1">
<li>High latitude countries: they don’t necessarily have high mountains but part of the territory is frozen due to being located on high latitudes and are therefore less intensely heated by the sun. The cold temperature even at low altitudes allows some land to remain frozen all year round.</li>
<li>Mountainous countries: despite being located on mid-range latitudes, high-altitudes mountains and plateau allow the existence of glaciers and permafrost. Heavy snowfall during the winter allow for the renewal of glaciers that partially melt in summer providing fresh water to downstream valleys.</li>
</ol>
<p>Two trends can be noted among the countries that do not depend on ice for their freshwater resources:</p>
<ol type="1">
<li>A larger part of fresh water lake surface is on rivers. A large amount is therefore more downstream.</li>
<li>They rely more heavily on artificial reservoirs. We will in the following that glacier-fed lakes are less impacted by drought in the summer as the glacier melting provides fresh water even when it doesn’t rain. It is not the case for other lakes which can vary greatly depending on rainfall. Building artificial reservoirs can be a solution to try and alleviate droughts.</li>
</ol>
<p>In the rest of the work, we will focus on North America and the United States.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate sample data (longitude, latitude, and heat values)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>North_America <span class="ot">&lt;-</span> count_types</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>North_America<span class="sc">$</span>longitude <span class="ot">&lt;-</span> GLRSED<span class="sc">$</span>Longitude</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>North_America<span class="sc">$</span>latitude <span class="ot">&lt;-</span> GLRSED<span class="sc">$</span>Latitude</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>North_America<span class="sc">$</span>Hylak_ID <span class="ot">&lt;-</span> GLRSED<span class="sc">$</span>Hylak_ID</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>North_America <span class="ot">&lt;-</span> North_America<span class="sc">%&gt;%</span><span class="fu">filter</span>(Continent <span class="sc">==</span> <span class="st">"North America"</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>lon_bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>lat_bin_size <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the data into 10x10 squares</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>summarized_North_America <span class="ot">&lt;-</span> North_America <span class="sc">%&gt;%</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">LonBin =</span> <span class="fu">cut</span>(longitude, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">180</span>, <span class="dv">180</span>, lon_bin_size), <span class="at">labels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">LatBin =</span> <span class="fu">cut</span>(latitude, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="dv">90</span>, lat_bin_size), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LonBin, LatBin) <span class="sc">%&gt;%</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Number_of_Lakes =</span> <span class="fu">n</span>(),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_area =</span> <span class="fu">sum</span>(Lake_area),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">nMountain =</span> <span class="fu">sum</span>(Mountain),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">nGlacier =</span> <span class="fu">sum</span>(Glacier),</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">nPermafrost =</span> <span class="fu">sum</span>(Permafrost),</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Latitude =</span> (<span class="fu">min</span>(latitude)<span class="sc">%/%</span>lat_bin_size) <span class="sc">*</span>lat_bin_size,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Longitude =</span> (<span class="fu">min</span>(longitude)<span class="sc">%/%</span>lon_bin_size) <span class="sc">*</span>lon_bin_size</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>area_score <span class="ot">&lt;-</span> North_America <span class="sc">%&gt;%</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">LonBin =</span> <span class="fu">cut</span>(longitude, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">180</span>, <span class="dv">180</span>, lon_bin_size), <span class="at">labels =</span> <span class="cn">FALSE</span>),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">LatBin =</span> <span class="fu">cut</span>(latitude, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="dv">90</span>, lat_bin_size), <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(LonBin, LatBin, Glacier, Permafrost) <span class="sc">%&gt;%</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lake_area =</span> <span class="fu">sum</span>(Lake_area)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Glacier<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> Permafrost<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>summarized_North_America <span class="ot">&lt;-</span> <span class="fu">merge</span>(summarized_North_America, area_score, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"LonBin"</span>, <span class="st">"LatBin"</span>), <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>summarized_North_America[<span class="fu">is.na</span>(summarized_North_America)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>summarized_North_America<span class="sc">$</span>score <span class="ot">&lt;-</span>summarized_North_America<span class="sc">$</span>Lake_area<span class="sc">/</span>summarized_North_America<span class="sc">$</span>Total_area <span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summarized_North_America, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">fill =</span> score)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">borders</span>(<span class="st">"world"</span>, <span class="at">regions =</span> <span class="fu">c</span>(<span class="st">"USA"</span>, <span class="st">"Canada"</span>, <span class="st">"Greenland"</span>, <span class="st">"Mexico"</span>,<span class="st">"Belize"</span>,<span class="st">"Costa Rica"</span>, <span class="st">"Cuba"</span>, <span class="st">"Dominican Republic"</span>, <span class="st">"El Salvador"</span>, <span class="st">"Guatemala"</span>, <span class="st">"Haiti"</span>, <span class="st">"Honduras"</span>, <span class="st">"Jamaica"</span>,<span class="st">"Martinique"</span>, <span class="st">"Nicaragua"</span>, <span class="st">"NORTHERN MARIANA ISLANDS"</span>, <span class="st">"Panama"</span>, <span class="st">"Puerto Rico"</span>, <span class="st">"Trinidad and Tobago"</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">borders</span>(<span class="st">"state"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">180</span>, <span class="dv">0</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">90</span>))<span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>))<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Dependence on Glacier and Permafrost water accross North America"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The center of Greenland appears in light blue as we don’t have any lake data for it. It could either because the lakes were not registered in the dataset or because there is no lake. As expected with the categories mentioned above, the larger part of Canada and Alaska heavily rely on permafrost water. High latitudes allow for frozen land all year round. They are high latitude category identified previously.</p>
<p>In the US, the rocky mountains show up as a red trail. The glaciers in high altitude in the mountains provide water for the area. They are part of the high altitude category identified before.</p>
</section>
<section id="evolution-of-glacier-fed-lakes-in-the-us" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="evolution-of-glacier-fed-lakes-in-the-us"><span class="header-section-number">3.2</span> Evolution of glacier-fed lakes in the US</h2>
<p>In this part, we are now using the RealSAT dataset which contains the monthly surface variations of lakes between 1985 and 2020. The goal here is to try to identify a trend for glacier-fed lakes over that period of time.</p>
<p>The code to extract the timeseries from the RealSAT dataset is inspired by the paper ReaLSAT, a global dataset of reservoir and lake surface area variations by Ankush Khandelwal, Anuj Karpatne, Zhihao Wei, Rahul Ghosh, Hilary Dugan, Paul Hanson and Vipin Kumar.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#code from ReaLSAT, a global dataset of reservoir and lake surface area variations Creators Ankush Khandelwal ORCID Anuj Karpatne Zhihao Wei Rahul Ghosh Hilary Dugan Paul Hanson Vipin Kumar</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the average missing percentage before and after any given timestep is more than the threshold</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>prune_time_steps <span class="ot">&lt;-</span> <span class="cf">function</span>(fill_ts, window_size) {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">&lt;-</span> <span class="fu">length</span>(fill_ts)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  prn_ts <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>, T)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(T <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    cur_ts_before <span class="ot">&lt;-</span> fill_ts[<span class="fu">max</span>(<span class="dv">1</span>, j <span class="sc">-</span> window_size)<span class="sc">:</span>j]</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    cur_ts_after <span class="ot">&lt;-</span> fill_ts[(j <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">min</span>(j <span class="sc">+</span> window_size <span class="sc">+</span> <span class="dv">1</span>, T)]</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">mean</span>(cur_ts_before)<span class="sc">&gt;</span><span class="dv">90</span> <span class="sc">|</span> <span class="fu">mean</span>(cur_ts_after)<span class="sc">&gt;</span><span class="dv">90</span>){prn_ts[j] <span class="ot">&lt;-</span> <span class="cn">TRUE</span>}</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fill_ts[<span class="dv">1</span>]<span class="sc">&gt;</span><span class="dv">90</span>){</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    prn_ts[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fill_ts[T<span class="dv">-1</span>]<span class="sc">&gt;</span><span class="dv">90</span>){</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    prn_ts[T<span class="dv">-1</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(prn_ts)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>make_dataframe <span class="ot">&lt;-</span> <span class="cf">function</span>(glacier_id, <span class="at">start_year=</span><span class="dv">1984</span>, <span class="at">end_year=</span><span class="dv">2020</span>) {</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  dyear <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1984</span>, <span class="dv">2020</span>), <span class="at">each =</span> <span class="dv">12</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  dyear <span class="ot">&lt;-</span>dyear[<span class="dv">1</span><span class="sc">:</span><span class="dv">442</span>]</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  dmonth <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">times =</span> <span class="dv">37</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  dmonth <span class="ot">&lt;-</span> dmonth[<span class="dv">1</span><span class="sc">:</span><span class="dv">442</span>]</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  area_ts <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(glacier_id[<span class="dv">3</span>, ]) <span class="sc">*</span> <span class="fl">0.0009</span>  <span class="co"># area timeseries in terms of number of pixels</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  fill_ts <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(glacier_id[<span class="dv">1</span>, ])  <span class="co"># percentage of missing glacier_800090 in each month</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  area_ts_gsw <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(glacier_id[<span class="dv">4</span>, ]) <span class="sc">*</span> <span class="fl">0.0009</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extracting timesteps where area values were potentially affected by a large amount of missing data around them.</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  bad_ts <span class="ot">&lt;-</span> <span class="fu">prune_time_steps</span>(fill_ts, <span class="dv">3</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  area_ts[bad_ts] <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># assigning NA values to the missing timesteps</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  area_ts_gsw[bad_ts] <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># assigning NA values to the missing timesteps</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Column1=</span>dyear, <span class="at">Column2=</span>area_ts, <span class="at">Column3=</span>area_ts_gsw, <span class="at">Column4=</span>dmonth)<span class="sc">%&gt;%</span><span class="fu">filter</span>(Column1<span class="sc">&gt;</span>start_year <span class="sc">&amp;</span> Column1<span class="sc">&lt;</span>end_year)</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>realSAT_US <span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/realsat/ReaLSAT-2-0/ReaLSAT.shp"</span>)<span class="sc">%&gt;%</span><span class="fu">filter</span>(CONTINENT<span class="sc">==</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `ReaLSAT' from data source 
  `C:\Users\meuni\Documents\EDAV\final project\realsat\ReaLSAT-2-0\ReaLSAT.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 681137 features and 14 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -176.8504 ymin: -55.88186 xmax: 178.7361 ymax: 51.8578
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>US <span class="ot">&lt;-</span> North_America<span class="sc">%&gt;%</span><span class="fu">filter</span>(Country<span class="sc">==</span><span class="st">"UNITED STATES"</span> <span class="sc">&amp;</span> <span class="sc">!</span>Hylak_ID<span class="sc">==</span><span class="st">'NA'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>US <span class="ot">&lt;-</span> <span class="fu">merge</span>(US, realSAT_US, <span class="at">by.x=</span><span class="st">"Hylak_ID"</span>, <span class="at">by.y=</span><span class="st">"Hylak_id"</span>, <span class="at">all.x=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>US <span class="ot">&lt;-</span> US<span class="sc">%&gt;%</span><span class="fu">filter</span>(<span class="sc">!</span>ID<span class="sc">==</span><span class="st">'NA'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="glacier-fed-lakes-from-the-rocky-mountains" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="glacier-fed-lakes-from-the-rocky-mountains"><span class="header-section-number">3.2.1</span> Glacier-fed lakes from the Rocky Mountains</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>glacier_712529 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/monthly_timeseries_-120_40/ID_712529.csv"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>glacier_712529 <span class="ot">&lt;-</span> <span class="fu">make_dataframe</span>(glacier_712529)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>glacier_677013 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/monthly_timeseries_-110_40/ID_677013.csv"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>glacier_677013 <span class="ot">&lt;-</span> <span class="fu">make_dataframe</span>(glacier_677013)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>glacier_676761 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/monthly_timeseries_-120_40/ID_676761.csv"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>glacier_676761 <span class="ot">&lt;-</span> <span class="fu">make_dataframe</span>(glacier_676761)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>glacier_671117 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/monthly_timeseries_-110_40/ID_671117.csv"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>glacier_671117 <span class="ot">&lt;-</span> <span class="fu">make_dataframe</span>(glacier_671117)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>glacier_733649 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/monthly_timeseries_-120_30/ID_733649.csv"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>glacier_733649 <span class="ot">&lt;-</span> <span class="fu">make_dataframe</span>(glacier_733649)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>glacier_711481 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/monthly_timeseries_-110_40/ID_711481.csv"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>glacier_711481 <span class="ot">&lt;-</span> <span class="fu">make_dataframe</span>(glacier_711481)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">420</span>, <span class="at">ncol =</span> <span class="dv">0</span>))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>year <span class="ot">&lt;-</span> glacier_712529<span class="sc">$</span>Column1</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>month <span class="ot">&lt;-</span> glacier_712529<span class="sc">$</span>Column4</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>glacier_712529 <span class="ot">&lt;-</span> glacier_712529<span class="sc">$</span>Column2</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>glacier_677013 <span class="ot">&lt;-</span> glacier_677013<span class="sc">$</span>Column2</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>glacier_676761 <span class="ot">&lt;-</span> glacier_676761<span class="sc">$</span>Column2</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>glacier_671117 <span class="ot">&lt;-</span> glacier_671117<span class="sc">$</span>Column2</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>glacier_733649 <span class="ot">&lt;-</span> glacier_733649<span class="sc">$</span>Column2</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>glacier_711481 <span class="ot">&lt;-</span> glacier_711481<span class="sc">$</span>Column2</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>month_code <span class="ot">&lt;-</span> month.abb[US_glacier_timeseries<span class="sc">$</span>month <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>US_glacier_timeseries<span class="sc">$</span>month_code <span class="ot">&lt;-</span> <span class="fu">factor</span>(US_glacier_timeseries<span class="sc">$</span>month_code, <span class="at">levels =</span> month.abb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We selected 6 lakes among the glacier-fed lakes in the US to study their variations in surface over the 35-year span and their average seasonal surface variations. The sample chosen contains lakes from different sizes and locations accross the Rocky Mountains. A bias in this sample cannot be ruled out, as we did not focus on obtaining a representative random sample. The observations made here only serve to develop an intuition about glacial lakes in the USA. The plots and the tendency line - using loess method - are influenced by missing values. For some lakes, surface was only measured during the spring and summer. A few years are also missing.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>melted_data <span class="ot">&lt;-</span> <span class="fu">melt</span>(US_glacier_timeseries, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month_code"</span>, <span class="st">"month"</span>), <span class="at">variable.name =</span> <span class="st">"lake"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted line plot</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_data, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> value, <span class="at">group =</span> lake, <span class="at">color =</span> month_code)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variations of Lake Surface Over the Years"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Surface sq.kms"</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Among the six glacier-fed lakes selected:</p>
<ul>
<li>two seem to have been decreasing in size during the last 35 years.</li>
<li>the rest seem to have a relatively stable size.</li>
</ul>
<p>The glacier-fed lake with id 711481 seems to have been growing in size from 1985 to 2000. This could be due to increased melting of the glacier, releasing more water than before.</p>
<p>Overall, we cannot conclude that there has been a significant reduction in surface area of these glacier-fed lakes. But that’s not to say that the gradual disappearance of glaciers doesn’t pose a threat to these lakes and the water supply they provide. Indeed, in recent years, glaciers have continued to melt in summer at a rate similar to or even greater than in previous decades, allowing the lakes downstream to fill up. However, winter snowfalls are no longer sufficient to compensate for summer melting, putting glaciers - the majority of which are set to disappear by 2050 - and their associated lakes at risk in the long term.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_data, <span class="fu">aes</span>(<span class="at">x =</span> month_code, <span class="at">y =</span> value, <span class="at">group =</span> lake, <span class="at">color =</span> year)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Seasonal Variations of Lake Surface"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Surface sq.kms"</span>) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Despite the missing data for the winter months in some plots, a clear tendency can be highlighted for the seasonal variations of glacier-fed lake surface: the surface increases during the summer months and decreases during the winter. The explanation for this phenomenon is simple: glaciers and winter snow melt during the summer, filling downstream lakes and swelling torrents. During the winter, low temperatures prevent the glaciers from melting, so they don’t release any fresh water.</p>
</section>
<section id="control-lakes-not-glacier-fed" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="control-lakes-not-glacier-fed"><span class="header-section-number">3.2.2</span> Control lakes, not glacier-fed</h3>
<p>To better understand the specificity of glacier-fed lakes, we will briefly look at the variations of surface from 1985 to 2020 and the monthly variations of lakes that are not glacier-fed.</p>
<p>The remark made at the previous paragraph is still valid for sampling method here. The data was formatted using the same code as before and saved in .csv.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>US_lake_timeseries <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/ReaLSAT/monthly_timeseries/US_lake_timeseries.csv"</span>)<span class="sc">%&gt;%</span><span class="fu">select</span>(<span class="sc">!</span>lake_676761)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>US_lake_timeseries<span class="sc">$</span>month_code <span class="ot">&lt;-</span> <span class="fu">factor</span>(US_lake_timeseries<span class="sc">$</span>month_code, <span class="at">levels =</span> month.abb)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>melted_data_lake <span class="ot">&lt;-</span> <span class="fu">melt</span>(US_lake_timeseries, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"month_code"</span>, <span class="st">"month"</span>), <span class="at">variable.name =</span> <span class="st">"lake"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted line plot</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_data_lake, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> value, <span class="at">group =</span> lake, <span class="at">color =</span> month_code)) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variations of Lake Surface Over the Years"</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Surface sq.kms"</span>) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Four of these lakes have had their surface increase from 1985. As they are from different parts of the US it is difficult to provide a single explanation for this phenomenon. Later in this work we will explore the correlation with temperature, precipitation and snowfall to try to find an explanation for these variations for lakes around Boulder, CO.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_data_lake, <span class="fu">aes</span>(<span class="at">x =</span> month_code, <span class="at">y =</span> value, <span class="at">group =</span> lake, <span class="at">color =</span> year)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Seasonal Variations of Lake Surface"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Surface sq.kms"</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Missing data makes this plot harder to interpret as it causes the large surface decrease in autumn in many of the plots.</p>
<p>For the most part, no clear seasonal tendency appears:</p>
<ul>
<li>Two lakes have an important decrease during spring.</li>
<li>Two have relatively stable surfaces throughout the year</li>
<li>Two have their surface increasing during spring and decreasing afterward.</li>
</ul>
<p>We can thus see that the trends highlighted in the previous paragraph are specific to glacier-fed lakes.</p>
</section>
</section>
<section id="the-impact-of-temperature-precipitation-and-snowfall-on-the-surface-variations-of-lakes-in-the-boulder-area-co" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="the-impact-of-temperature-precipitation-and-snowfall-on-the-surface-variations-of-lakes-in-the-boulder-area-co"><span class="header-section-number">3.3</span> The impact of temperature, precipitation and snowfall on the surface variations of lakes in the Boulder area, CO</h2>
<p>This paragraph is an attempt to look at the correlation between precipitations, snowfalls, temperature and surface variations of lakes near Boulder, Colorado. The precipitation, temperature and snowfall monthly records are provided by the Colorado Climate Center from Colorado State University. The data we use is collected at the Boulder weather station from January 1984 to December 2022.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>boulder_weather <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/Boulder_weather_data.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>boulder_glacier <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/realsat/monthly_timeseries/US_glacierBoulder_timeseries.csv"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>boulder_lake <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/meuni/Documents/EDAV/final project/realsat/monthly_timeseries/US_lakeBoulder_timeseries.csv"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>boulder_glacier<span class="sc">$</span>month_code <span class="ot">&lt;-</span> <span class="fu">factor</span>(boulder_glacier<span class="sc">$</span>month_code, <span class="at">levels =</span> month.abb)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>boulder_average_monthly <span class="ot">&lt;-</span> boulder_glacier<span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">maxTemp=</span><span class="fu">mean</span>(maxTemp, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">minTemp=</span><span class="fu">mean</span>(minTemp, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">precip=</span><span class="fu">mean</span>(precip, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">snowfall=</span><span class="fu">mean</span>(snowfall, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">.by=</span>month_code)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>boulder_average_year <span class="ot">&lt;-</span> boulder_glacier<span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">maxTemp=</span><span class="fu">max</span>(maxTemp, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">minTemp=</span><span class="fu">min</span>(minTemp, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">precip=</span><span class="fu">sum</span>(precip, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">snowfall=</span><span class="fu">sum</span>(snowfall, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="at">.by=</span>year)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(boulder_average_year, <span class="fu">aes</span>(<span class="at">x=</span>year))<span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>maxTemp), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>minTemp), <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>precip<span class="sc">/</span><span class="dv">10</span>), <span class="at">fill=</span><span class="st">"lightblue"</span>)<span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>snowfall<span class="sc">/</span><span class="dv">10</span>), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Temperature (°F)"</span>,</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">10</span>, <span class="at">name =</span> <span class="st">"Precipitation (mm)"</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(boulder_average_monthly, <span class="fu">aes</span>(<span class="at">x=</span>month_code))<span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>maxTemp), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>minTemp), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>precip), <span class="at">fill=</span><span class="st">"lightblue"</span>)<span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>snowfall), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Temperature (°F)"</span>,</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>., <span class="at">name =</span> <span class="st">"Precipitation (mm)"</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Temperature, Precipitation and Snowfall in Boulder, CO"</span>)<span class="sc">+</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(month, year, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The seasonal weather in Boulder, CO in brief:</p>
<ul>
<li>the max temperature (red line) is reached in summer and is around 80°F.</li>
<li>the min temperature (blue line) follows the same trend and there is a almost constant day/night difference of 25°F.</li>
<li>from October to April, there are significant snowfalls (white bars)</li>
<li>there is a little rain from April to September (blue bars)</li>
</ul>
<p>Since 1984:</p>
<ul>
<li>the yearly min and max temperature seem to be slightly increasing.</li>
<li>Snowfalls and precipitation seem quite stable with a few exceptional years.</li>
</ul>
<section id="impact-of-temperature-on-surface-variations" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="impact-of-temperature-on-surface-variations"><span class="header-section-number">3.3.1</span> Impact of temperature on surface variations</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>boulder_2010_2015 <span class="ot">&lt;-</span> boulder_glacier<span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month_code, maxTemp, minTemp, precip, snowfall, glacier_671117, date)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>boulder_2010_2015<span class="sc">$</span>lake_719135 <span class="ot">&lt;-</span> boulder_lake<span class="sc">$</span>lake_719135</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>boulder_2010_2015<span class="ot">&lt;-</span> boulder_2010_2015<span class="sc">%&gt;%</span><span class="fu">filter</span>(year<span class="sc">&gt;</span><span class="dv">2010</span> <span class="sc">&amp;</span> year<span class="sc">&lt;</span><span class="dv">2015</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>boulder_2010_2015<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste</span>(boulder_2010_2015<span class="sc">$</span>date, <span class="st">"01"</span>, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>melted_data_boulder <span class="ot">&lt;-</span> <span class="fu">melt</span>(boulder_2010_2015, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"date"</span>, <span class="st">"month_code"</span>, <span class="st">"minTemp"</span>, <span class="st">"maxTemp"</span>, <span class="st">"precip"</span>, <span class="st">"snowfall"</span>), <span class="at">variable.name =</span> <span class="st">"lake"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted line plot</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_data_boulder, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">group =</span> lake, <span class="at">color =</span> month_code)) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>maxTemp<span class="sc">/</span><span class="dv">400</span>), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>minTemp<span class="sc">/</span><span class="dv">400</span>), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Area sq.kms"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">400</span>, <span class="at">name =</span> <span class="st">"Temperature (°F)"</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="st">"1 year"</span>),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%Y"</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph compares the variations of surface of a glacier-fed lake and glacier-unrelated lake from the Boulder area between 2011 and 2015. In red and blue, the max and min temperature are respectively displayed.</p>
<p>In the case of the glacier lake, an increase in temperature is correlated with an increase in surface of the lake: when the temperature increases the glacier starts melting and therefore providing freshwater to the lake downstream.</p>
<p>In the case of the other lake, it seems like high temperature are lows regarding surface lakes. Here it might be due to evaporation of water from the lake.</p>
</section>
<section id="impact-of-snowfalls-and-precipitation-on-surface-variations" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="impact-of-snowfalls-and-precipitation-on-surface-variations"><span class="header-section-number">3.3.2</span> Impact of snowfalls and precipitation on surface variations</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a faceted line plot</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_data_boulder, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">group =</span> lake, <span class="at">color =</span> month_code)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>precip<span class="sc">/</span><span class="dv">100</span>),<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>snowfall<span class="sc">/</span><span class="dv">100</span>), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Area sq.kms"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">400</span>, <span class="at">name =</span> <span class="st">"Precipiation (mm)"</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>lake, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="st">"1 year"</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%Y"</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph compares the variations of surface of a glacier-fed lake and glacier-unrelated lake from the Boulder area between 2011 and 2015. In white and light blue, the snowfall and precipitation are respectively displayed.</p>
<p>In the case of the glacier lake, precipitation and snowfall don’t seem have an impact on the surface of the lake. During the winter, snowfalls don’t impact the surface of the lake as it may be frozen. During the summer, the glacier consistently provides fresh water to the lake making it less dependent on rainfall.</p>
<p>In the case of the other lake, it seems like important snowfalls and precipitations are correlated to an increase in surface. This seems logical: this lake is partly filled by rainfall or snowfall.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./d3graph.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>